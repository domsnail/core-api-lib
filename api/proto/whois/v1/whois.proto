syntax = "proto3";
package domsnail.whois.v1;

option go_package = "github.com/domsnail/core-api-lib/gen/go/api/proto/whois/v1;whoisv1";

import "protoc-gen-openapiv2/options/annotations.proto";

import "google/protobuf/timestamp.proto";
import "api/proto/host/v1/host.proto";

message ProbeOptions {
  hosts.v1.Host host = 1 [(grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
    description: "Host to be scanned"
  }];;
}

// notice: https://github.com/infobloxopen/protoc-gen-gorm

message WhoisInfo {
  string host = 1;
  string raw_data = 2;
  string source_server = 3;

  // request uuid is stored in metadata

  // redirected is used to link to data sourced from original whois server
  optional WhoisInfo redirected = 5;

  google.protobuf.Timestamp created_at = 6;
}